import{r as o,h as i,F as s}from"./p-cc7ce8c7.js";import{s as e}from"./p-d93fa5d8.js";import"./p-e01776ef.js";import{s as t,c as r,e as l,b as n}from"./p-ede11f08.js";import{d,s as a}from"./p-2934ec66.js";import{a as c}from"./p-c6074574.js";import{l as u,b as p}from"./p-28aaf9ba.js";import{a as m}from"./p-18e45a13.js";import{M as v}from"./p-98ef7a65.js";import{c as f}from"./p-05fc1ee0.js";import{a as h}from"./p-1c2e2695.js";import{s as y}from"./p-38a11668.js";import{o as j}from"./p-c27fae79.js";import{c as g}from"./p-a27e9b70.js";import{u as b}from"./p-f47b68d0.js";import"./p-25433d0f.js";import"./p-c06b2e12.js";import"./p-f70181c4.js";import"./p-4d73f82a.js";import"./p-7ef0f71c.js";import"./p-9a954102.js";import"./p-09484d0e.js";const k=(o,i,s)=>d("set",((e,t,r)=>{if(e!==o)return;if(Array.isArray(i)){if(i.some((o=>JSON.stringify(t===null||t===void 0?void 0:t[o])!==JSON.stringify(r===null||r===void 0?void 0:r[o])))){return s(t,r)}}if(typeof i==="string"){if(JSON.stringify(t===null||t===void 0?void 0:t[i])===JSON.stringify(r===null||r===void 0?void 0:r[i]))return;return s(t===null||t===void 0?void 0:t[i],r===null||r===void 0?void 0:r[i])}}));const w=":host{display:block}";const _=class{constructor(i){o(this,i);this.processorId=undefined;this.method=undefined;this.error=undefined;this.methods=undefined}componentWillLoad(){e.id="mollie";this.fetchMethods();k("checkout",["total_amount","currency","reusabled_payment_method_required","shipping_address"],(()=>this.fetchMethods()))}async fetchMethods(){var o;const i=a.checkout;if(!(i===null||i===void 0?void 0:i.currency)||!(i===null||i===void 0?void 0:i.total_amount))return;try{u("methods");const s=await m({path:h(`surecart/v1/processors/${this.processorId}/payment_method_types`,{amount:i===null||i===void 0?void 0:i.total_amount,country:((o=i===null||i===void 0?void 0:i.shipping_address)===null||o===void 0?void 0:o.country)||"us",currency:i===null||i===void 0?void 0:i.currency,...(i===null||i===void 0?void 0:i.reusable_payment_method_required)?{reusable:i===null||i===void 0?void 0:i.reusable_payment_method_required}:{},per_page:100})});t.methods=(s===null||s===void 0?void 0:s.data)||[]}catch(o){f(o);console.error(o)}finally{p("methods")}}renderLoading(){return i("sc-card",null,i("sc-skeleton",{style:{width:"50%",marginBottom:"0.5em"}}),i("sc-skeleton",{style:{width:"30%",marginBottom:"0.5em"}}),i("sc-skeleton",{style:{width:"60%",marginBottom:"0.5em"}}))}render(){var o,e,t;if(c("methods")&&!((o=r())===null||o===void 0?void 0:o.length)){return this.renderLoading()}if(!((e=a.checkout)===null||e===void 0?void 0:e.currency)){return this.renderLoading()}if(!((t=r())===null||t===void 0?void 0:t.length)){return i("sc-alert",{type:"warning",open:true},wp.i18n.__("No available payment methods","surecart")," ")}const d=l()?"sc-toggles":"div";return i(s,null,i(d,{collapsible:false,theme:"container"},(r()||[]).map((o=>i("sc-payment-method-choice",{"processor-id":"mollie","method-id":o===null||o===void 0?void 0:o.id,key:o===null||o===void 0?void 0:o.id},i("span",{slot:"summary",class:"sc-payment-toggle-summary"},!!(o===null||o===void 0?void 0:o.image)&&i("img",{src:o===null||o===void 0?void 0:o.image,"aria-hidden":"true"}),i("span",null,o===null||o===void 0?void 0:o.description)),i("sc-card",null,i("sc-payment-selected",{label:wp.i18n.sprintf(wp.i18n.__("%s selected for check out.","surecart"),o===null||o===void 0?void 0:o.description)},!!(o===null||o===void 0?void 0:o.image)&&i("img",{slot:"icon",src:o===null||o===void 0?void 0:o.image,style:{width:"32px"}}),wp.i18n.__("Another step will appear after submitting your order to complete your purchase details.","surecart")))))),i(v,{methods:n()})),!!c("methods")&&i("sc-block-ui",{class:"busy-block-ui","z-index":9,style:{"--sc-block-ui-opacity":"0.4"}}))}};_.style=w;const S=class{constructor(i){o(this,i)}componentWillLoad(){this.unlistenToFormState=j("formState",(()=>{if("paying"===g()){this.confirm()}}))}disconnectedCallback(){this.unlistenToFormState()}async confirm(){var o,i,s,t;if((e===null||e===void 0?void 0:e.id)!=="paystack")return;if(!((i=(o=a===null||a===void 0?void 0:a.checkout)===null||o===void 0?void 0:o.payment_intent)===null||i===void 0?void 0:i.processor_data.paystack))return;if(((s=a===null||a===void 0?void 0:a.checkout)===null||s===void 0?void 0:s.status)==="paid")return;try{const{public_key:o,access_code:i}=(t=a===null||a===void 0?void 0:a.checkout)===null||t===void 0?void 0:t.payment_intent.processor_data.paystack;if(!o||!i){f({message:wp.i18n.sprintf(wp.i18n.__("Payment gateway configuration incomplete. Please ensure Paystack is properly configured for transactions.","surecart"))});return}const s=new y;await s.newTransaction({key:o,accessCode:i,onSuccess:async o=>{if((o===null||o===void 0?void 0:o.status)!=="success"){throw{message:wp.i18n.sprintf(wp.i18n.__("Paystack transaction could not be finished. Status: %s","surecart"),o===null||o===void 0?void 0:o.status)}}return b("PAID")},onClose:()=>b("REJECT")})}catch(o){f(o);console.error(o);b("REJECT")}}};export{_ as sc_checkout_mollie_payment,S as sc_checkout_paystack_payment_provider};
//# sourceMappingURL=p-d8b957fb.entry.js.map