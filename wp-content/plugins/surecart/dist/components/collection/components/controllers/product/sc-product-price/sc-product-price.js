import{h,Fragment,Host}from"@stencil/core";import{__,_n,sprintf}from"@wordpress/i18n";import{state}from"@store/product";import{intervalString}from"../../../../functions/price";export class ScProductPrice{constructor(){this.prices=void 0,this.saleText=void 0,this.productId=void 0}renderRange(){var e,r,t,i;return 1===(null===(r=null===(e=state[this.productId])||void 0===e?void 0:e.prices)||void 0===r?void 0:r.length)?this.renderPrice(null===(t=state[this.productId])||void 0===t?void 0:t.prices[0]):h("sc-price-range",{prices:null===(i=state[this.productId])||void 0===i?void 0:i.prices})}renderVariantPrice(e){var r,t;const i=null===(t=null===(r=state[this.productId])||void 0===r?void 0:r.variants)||void 0===t?void 0:t.find((r=>(null==r?void 0:r.id)===(null==e?void 0:e.id)));return this.renderPrice(state[this.productId].selectedPrice,null==i?void 0:i.amount)}renderPrice(e,r){var t;const i=null!==(t=null!=r?r:null==e?void 0:e.amount)&&void 0!==t?t:0;return(null==e?void 0:e.ad_hoc)?__("Custom Amount","surecart"):h(Fragment,null,h("div",{class:"price",id:"price"},h("div",{class:"price__amounts"},!!(null==e?void 0:e.scratch_amount)&&(null==e?void 0:e.scratch_amount)!==i&&h(Fragment,null,0===(null==e?void 0:e.scratch_amount)?__("Free","surecart"):h(Fragment,null,h("sc-visually-hidden",null,__("The price was","surecart")," "),h("sc-format-number",{class:"price__scratch",part:"price__scratch",type:"currency",currency:e.currency,value:null==e?void 0:e.scratch_amount}),h("sc-visually-hidden",null," ",__("now discounted to","surecart")))),0===i?__("Free","surecart"):h("sc-format-number",{class:"price__amount",type:"currency",value:i,currency:null==e?void 0:e.currency}),h("div",{class:"price__interval"},(null==e?void 0:e.recurring_period_count)&&1<(null==e?void 0:e.recurring_period_count)&&h("sc-visually-hidden",null," ",__("This is a repeating price. Payment will happen","surecart")," ",intervalString(e,{showOnce:!0,abbreviate:!1,labels:{interval:__("every","surecart"),period:
/** translators: used as in time period: "for 3 months" */
__("for","surecart")}})),h("span",{"aria-hidden":"true"},intervalString(e,{showOnce:!0,abbreviate:!1,labels:{interval:"/",period:
/** translators: used as in time period: "for 3 months" */
__("for","surecart")}}))),!!(null==e?void 0:e.scratch_amount)&&h("sc-tag",{type:"primary",pill:!0,class:"price__sale-badge"},this.saleText||h(Fragment,null,h("sc-visually-hidden",null,__("This product is available for sale.","surecart")," "),h("span",{"aria-hidden":"true"},__("Sale","surecart"))))),(!!(null==e?void 0:e.trial_duration_days)||!!(null==e?void 0:e.setup_fee_enabled)&&(null==e?void 0:e.setup_fee_amount))&&h("div",{class:"price__details"},!!(null==e?void 0:e.trial_duration_days)&&h(Fragment,null,h("sc-visually-hidden",null,sprintf(__("You have a %d-day trial before payment becomes necessary.","surecart"),e.trial_duration_days)),h("span",{class:"price__trial","aria-hidden":"true"},sprintf(_n("Starting in %s day.","Starting in %s days.",e.trial_duration_days,"surecart"),e.trial_duration_days))),!!(null==e?void 0:e.setup_fee_enabled)&&(null==e?void 0:e.setup_fee_amount)&&h("span",{class:"price__setup-fee"},h("sc-visually-hidden",null,__("This product has","surecart")," "),h("sc-format-number",{type:"currency",value:Math.abs(e.setup_fee_amount),currency:null==e?void 0:e.currency})," ",(null==e?void 0:e.setup_fee_name)||((null==e?void 0:e.setup_fee_amount)<0?__("Discount","surecart"):__("Setup Fee","surecart")),"."))))}render(){return h(Host,{role:"paragraph"},(()=>{var e,r;return(null===(e=state[this.productId])||void 0===e?void 0:e.selectedVariant)?this.renderVariantPrice(null===(r=state[this.productId])||void 0===r?void 0:r.selectedVariant):state[this.productId].selectedPrice?this.renderPrice(state[this.productId].selectedPrice):state[this.productId].prices.length?this.renderRange():h("slot",null)})())}static get is(){return"sc-product-price"}static get encapsulation(){return"shadow"}static get originalStyleUrls(){return{$:["sc-product-price.scss"]}}static get styleUrls(){return{$:["sc-product-price.css"]}}static get properties(){return{prices:{type:"unknown",mutable:!1,complexType:{original:"Price[]",resolved:"Price[]",references:{Price:{location:"import",path:"../../../../types"}}},required:!1,optional:!1,docs:{tags:[],text:"The product's prices."}},saleText:{type:"string",mutable:!1,complexType:{original:"string",resolved:"string",references:{}},required:!1,optional:!1,docs:{tags:[],text:"The sale text"},attribute:"sale-text",reflect:!1},productId:{type:"string",mutable:!1,complexType:{original:"string",resolved:"string",references:{}},required:!1,optional:!1,docs:{tags:[],text:"The product id"},attribute:"product-id",reflect:!1}}}}