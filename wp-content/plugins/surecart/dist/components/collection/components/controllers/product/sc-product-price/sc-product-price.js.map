{"version":3,"file":"sc-product-price.js","sourceRoot":"","sources":["../../../../../src/components/controllers/product/sc-product-price/sc-product-price.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, h, Prop, Fragment, Host } from '@stencil/core';\nimport { __, _n, sprintf } from '@wordpress/i18n';\nimport { Price, Variant } from '../../../../types';\nimport { state } from '@store/product';\nimport { intervalString } from '../../../../functions/price';\n\n@Component({\n  tag: 'sc-product-price',\n  styleUrl: 'sc-product-price.scss',\n  shadow: true,\n})\nexport class ScProductPrice {\n  /** The product's prices. */\n  @Prop() prices: Price[];\n\n  /** The sale text */\n  @Prop() saleText: string;\n\n  /** The product id */\n  @Prop() productId: string;\n\n  renderRange() {\n    if (state[this.productId]?.prices?.length === 1) {\n      return this.renderPrice(state[this.productId]?.prices[0]);\n    }\n    return <sc-price-range prices={state[this.productId]?.prices} />;\n  }\n\n  renderVariantPrice(selectedVariant: Variant) {\n    const variant = state[this.productId]?.variants?.find(variant => variant?.id === selectedVariant?.id);\n    return this.renderPrice(state[this.productId].selectedPrice, variant?.amount);\n  }\n\n  renderPrice(price: Price, variantAmount?: number) {\n    const amount = variantAmount ?? price?.amount ?? 0;\n\n    if (price?.ad_hoc) {\n      return __('Custom Amount', 'surecart');\n    }\n\n    return (\n      <Fragment>\n        <div class=\"price\" id=\"price\">\n          <div class=\"price__amounts\">\n            {!!price?.scratch_amount && price?.scratch_amount !== amount && (\n              <Fragment>\n                {price?.scratch_amount === 0 ? (\n                  __('Free', 'surecart')\n                ) : (\n                  <Fragment>\n                    <sc-visually-hidden>{__('The price was', 'surecart')} </sc-visually-hidden>\n                    <sc-format-number class=\"price__scratch\" part=\"price__scratch\" type=\"currency\" currency={price.currency} value={price?.scratch_amount}></sc-format-number>\n                    <sc-visually-hidden> {__('now discounted to', 'surecart')}</sc-visually-hidden>\n                  </Fragment>\n                )}\n              </Fragment>\n            )}\n\n            {amount === 0 ? __('Free', 'surecart') : <sc-format-number class=\"price__amount\" type=\"currency\" value={amount} currency={price?.currency}></sc-format-number>}\n\n            <div class=\"price__interval\">\n              {price?.recurring_period_count && 1 < price?.recurring_period_count && (\n                <sc-visually-hidden>\n                  {' '}\n                  {__('This is a repeating price. Payment will happen', 'surecart')}{' '}\n                  {intervalString(price, {\n                    showOnce: true,\n                    abbreviate: false,\n                    labels: {\n                      interval: __('every', 'surecart'),\n                      period:\n                        /** translators: used as in time period: \"for 3 months\" */\n                        __('for', 'surecart'),\n                    },\n                  })}\n                </sc-visually-hidden>\n              )}\n\n              <span aria-hidden=\"true\">\n                {intervalString(price, {\n                  showOnce: true,\n                  abbreviate: false,\n                  labels: {\n                    interval: '/',\n                    period:\n                      /** translators: used as in time period: \"for 3 months\" */\n                      __('for', 'surecart'),\n                  },\n                })}\n              </span>\n            </div>\n\n            {!!price?.scratch_amount && (\n              <sc-tag type=\"primary\" pill class=\"price__sale-badge\">\n                {this.saleText || (\n                  <Fragment>\n                    <sc-visually-hidden>{__('This product is available for sale.', 'surecart')} </sc-visually-hidden>\n                    <span aria-hidden=\"true\">{__('Sale', 'surecart')}</span>\n                  </Fragment>\n                )}\n              </sc-tag>\n            )}\n          </div>\n\n          {(!!price?.trial_duration_days || (!!price?.setup_fee_enabled && price?.setup_fee_amount)) && (\n            <div class=\"price__details\">\n              {!!price?.trial_duration_days && (\n                <Fragment>\n                  <sc-visually-hidden>{sprintf(__('You have a %d-day trial before payment becomes necessary.', 'surecart'), price.trial_duration_days)}</sc-visually-hidden>\n                  <span class=\"price__trial\" aria-hidden=\"true\">\n                    {sprintf(_n('Starting in %s day.', 'Starting in %s days.', price.trial_duration_days, 'surecart'), price.trial_duration_days)}\n                  </span>\n                </Fragment>\n              )}\n\n              {!!price?.setup_fee_enabled && price?.setup_fee_amount && (\n                <span class=\"price__setup-fee\">\n                  <sc-visually-hidden>{__('This product has', 'surecart')} </sc-visually-hidden>\n                  <sc-format-number type=\"currency\" value={Math.abs(price.setup_fee_amount)} currency={price?.currency}></sc-format-number>{' '}\n                  {price?.setup_fee_name || (price?.setup_fee_amount < 0 ? __('Discount', 'surecart') : __('Setup Fee', 'surecart'))}.\n                </span>\n              )}\n            </div>\n          )}\n        </div>\n      </Fragment>\n    );\n  }\n\n  render() {\n    return (\n      <Host role=\"paragraph\">\n        {(() => {\n          if (state[this.productId]?.selectedVariant) {\n            return this.renderVariantPrice(state[this.productId]?.selectedVariant);\n          }\n\n          if (state[this.productId].selectedPrice) {\n            return this.renderPrice(state[this.productId].selectedPrice);\n          }\n\n          if (state[this.productId].prices.length) {\n            return this.renderRange();\n          }\n\n          return <slot />;\n        })()}\n      </Host>\n    );\n  }\n}\n"]}