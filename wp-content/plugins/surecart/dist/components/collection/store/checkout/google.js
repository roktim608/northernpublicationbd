import{maybeConvertAmount}from"../../functions/currency";window.addEventListener("scAddedToCart",(function(o){var i,n,d,t,u,l,e,v,r;if(!(null===window||void 0===window?void 0:window.dataLayer)&&!(null===window||void 0===window?void 0:window.gtag))return;const a=o.detail;if(!(null===(i=null==a?void 0:a.price)||void 0===i?void 0:i.product))return;const c=[{item_id:null===(d=null===(n=a.price)||void 0===n?void 0:n.product)||void 0===d?void 0:d.id,item_name:null===(u=null===(t=a.price)||void 0===t?void 0:t.product)||void 0===u?void 0:u.name,item_variant:(a.variant_options||[]).join(" / "),price:maybeConvertAmount((null===(l=null==a?void 0:a.price)||void 0===l?void 0:l.amount)||0,(null===(e=a.price)||void 0===e?void 0:e.currency)||"USD"),currency:null===(v=a.price)||void 0===v?void 0:v.currency,quantity:a.quantity,discount:(null==a?void 0:a.discount_amount)?maybeConvertAmount((null==a?void 0:a.discount_amount)||0,(null===(r=a.price)||void 0===r?void 0:r.currency)||"USD"):0}];(null===window||void 0===window?void 0:window.gtag)&&window.gtag("event","add_to_cart",{items:c}),(null===window||void 0===window?void 0:window.dataLayer)&&(window.dataLayer.push({ecommerce:null}),window.dataLayer.push({event:"add_to_cart",ecommerce:{data:{items:c}}}))})),window.addEventListener("scCheckoutCompleted",(function(o){var i,n,d,t,u;if(!(null===window||void 0===window?void 0:window.dataLayer)&&!(null===window||void 0===window?void 0:window.gtag))return;const l=o.detail,e={transaction_id:null==l?void 0:l.id,value:maybeConvertAmount(null==l?void 0:l.total_amount,(null==l?void 0:l.currency)||"USD"),currency:(l.currency||"").toUpperCase(),...(null===(n=null===(i=null==l?void 0:l.discount)||void 0===i?void 0:i.promotion)||void 0===n?void 0:n.code)?{coupon:null===(t=null===(d=null==l?void 0:l.discount)||void 0===d?void 0:d.promotion)||void 0===t?void 0:t.code}:{},...(null==l?void 0:l.tax_amount)?{tax:maybeConvertAmount(null==l?void 0:l.tax_amount,(null==l?void 0:l.currency)||"USD")}:{},items:((null===(u=null==l?void 0:l.line_items)||void 0===u?void 0:u.data)||[]).map((o=>{var i,n,d,t,u,e,v;return{item_id:null===(n=null===(i=null==o?void 0:o.price)||void 0===i?void 0:i.product)||void 0===n?void 0:n.id,currency:(l.currency||"").toUpperCase(),item_name:(null===(t=null===(d=null==o?void 0:o.price)||void 0===d?void 0:d.product)||void 0===t?void 0:t.name)||"",discount:(null==o?void 0:o.discount_amount)?maybeConvertAmount((null==o?void 0:o.discount_amount)||0,(null===(u=null==o?void 0:o.price)||void 0===u?void 0:u.currency)||"USD"):0,price:maybeConvertAmount((null===(e=null==o?void 0:o.price)||void 0===e?void 0:e.amount)||0,(null===(v=null==o?void 0:o.price)||void 0===v?void 0:v.currency)||"USD"),quantity:(null==o?void 0:o.quantity)||1,item_variant:(o.variant_options||[]).join(" / ")}}))};(null===window||void 0===window?void 0:window.gtag)&&window.gtag("event","purchase",e),(null===window||void 0===window?void 0:window.dataLayer)&&(window.dataLayer.push({ecommerce:null}),window.dataLayer.push({event:"purchase",ecommerce:e}))}));